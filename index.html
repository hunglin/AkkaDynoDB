<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Akkadynodb by pamu</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Akkadynodb</h1>
        <h2>Dynamo like distributed database built using Akka Cluster</h2>
        <a href="https://github.com/pamu/AkkaDynoDB" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="akkadynodb-reactive-storage-service" class="anchor" href="#akkadynodb-reactive-storage-service" aria-hidden="true"><span class="octicon octicon-link"></span></a>AkkaDynoDB (Reactive Storage Service)</h1>

<p>Dynamo like distributed database built using Akka Cluster</p>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Introduction</strong>
</h2>

<p><em><strong>AkkaDynoDB</strong></em> is a <em>reactive</em> <em>storage</em> <em>service</em> inspired from the Amazon dynamo distributed database
which is Highly available, scalable and resilient database <a href="http://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf">All Things distributed Paper</a>.
With changing requirements of enterprise applications the way we build applications has been changing. With increasing number of
devices that connect to the internet the traffic per server has drastically changed over years and its going to increase much more in the
near future with the emergence of Internet of things(IOT). In order to cater to the changing requirements which cannot be handled by traditional architectures
many enterprises started adopting distributed architectures to spread load over large number of machines and handle user requests. These applications should also
handle data effectively and offer reliability to its users. As the number of users increasing the applications must also scalable well 
according to the need. Not only scalability and reliability users also expect 100% availability that means 0 down times even in case of 
database maintenance and data migration. In order to offer these essential features enterprises have been adopting certain best practices and techniques from 
different researches. <em><strong>Reactive design principles</strong></em> basically convey these best practices and how systems should be built from ground up to be scalable,
available and be resilient.</p>

<h2>
<a id="reactive-systems" class="anchor" href="#reactive-systems" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Reactive Systems</strong>
</h2>

<p><em><strong>Reactive Systems</strong></em> has these four traits</p>

<ol>
<li><p>Responsive     (Available in a responding state)</p></li>
<li><p>Resilient      (Fault tolerant)</p></li>
<li><p>Elastic        (Scalable)</p></li>
<li><p>Message Driven (Communicate by sending messages i.e core to distribution)</p></li>
</ol>

<p>Please read <a href="http://www.reactivemanifesto.org/">Reactive Manifesto</a> to know about what is to be reactive.</p>

<h2>
<a id="akka" class="anchor" href="#akka" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Akka</strong>
</h2>

<p><em><strong>Akka</strong></em> as mentioned here <a href="http://akka.io">akka.io</a> is a toolkit and runtime for building </p>

<ol>
<li><p>Highly Concurrent</p></li>
<li><p>Distributed</p></li>
<li><p>Resilient</p></li>
<li><p>Message-Driven  applications on JVM (Java Virtual Machine)</p></li>
</ol>

<p>Akka adheres to the reactive principles and offers abstractions to deal with concurrency, distribution and fault tolerance.</p>

<ol>
<li><p>For concurrency Akka offers Scala Futures and Agents.     (Helps Scale up)</p></li>
<li><p>For Distribution and Remoting it offers Actors.           (Helps Scale Out)</p></li>
<li><p>For Fault tolerance Actor Supervision.                    (Deal with Failure)</p></li>
</ol>

<p>Note: The above mentioned is not exhaustive list of what akka offers. Please visit <a href="http://akka.io">Akka Website</a> for more.</p>

<p>More about actors <a href="http://arxiv.org/pdf/1008.1459.pdf">Actor Model</a>, <a href="http://publications.csail.mit.edu/lcs/pubs/pdf/MIT-LCS-TR-194.pdf">Actor Model</a>.</p>

<h2>
<a id="actor" class="anchor" href="#actor" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Actor</strong>
</h2>

<p><em><strong>Actor Model</strong></em> of concurrent computation provides a primitive called as <strong>Actor</strong>. </p>

<p>Actor is an entity which can do these three things</p>

<ol>
<li><p>Communicate with message passing (can communicate)</p></li>
<li><p>Create new actors (Can create new actors)</p></li>
<li><p>decide what to do with next message (Can change its behaviour on receiving a message)</p></li>
</ol>

<p>Actors can also have mutable state and can take local decisions. Actors can be used for distributing work among different machines.
With the help of actors work can be distributed among other worker actors and performed in a concurrent and distributed manner.
Actors provide location transparency by which same semantics of communication that are used for local actors can be used with remote actors.
Running potential long running code inside the actor makes the actor deaf to the messages that are sent to it. So, it is recommend to
wrap long running code inside a Future and execute it.Akka provides handy syntax to do the same.</p>

<div class="highlight highlight-scala"><pre>
  <span class="pl-k">object</span> <span class="pl-en">MasterActor</span> {
      <span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">StartWork</span>
  }

  <span class="pl-k">class</span> <span class="pl-en">MasterActor</span> <span class="pl-k">extends</span> <span class="pl-e">Actor</span> <span class="pl-k">with</span> <span class="pl-e">ActorLogging</span> {
      <span class="pl-k">def</span> <span class="pl-en">receive</span> <span class="pl-k">=</span> {
          <span class="pl-k">case</span> <span class="pl-en">StartWork</span> <span class="pl-k">=&gt;</span> {
              <span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> <span class="pl-en">Future</span> {
                 longRunningCode
             }
             future pipeTo <span class="pl-v">self</span> <span class="pl-c">//pipe feature</span>
          }
          <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> log.info(<span class="pl-s"><span class="pl-pds">"</span>unknown message<span class="pl-pds">"</span></span>)
      }
      <span class="pl-k">def</span> <span class="pl-en">longRunningCode</span><span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span> <span class="pl-en">Thread</span>.sleep(<span class="pl-c1">1000000</span>)
  }
</pre></div>

<h2>
<a id="akka-cluster" class="anchor" href="#akka-cluster" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Akka Cluster</strong>
</h2>

<p>Akka Cluster </p>

<p>Akka Cluster provides a fault tolerant decentralized peer-to-peer based cluster membership service with no 
single point of failure or single point of bottleneck. It does this using gossip protocols and a automatic failure
detector <a href="http://doc.akka.io/docs/akka/snapshot/common/cluster.html#cluster">Akka Cluster Specification Into</a></p>

<p>Please have a look at Akka Cluster documentation here <a href="http://akka.io/docs">Akka Cluster</a></p>

<h2>
<a id="akkadynodb-architecture" class="anchor" href="#akkadynodb-architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>AkkaDynoDB Architecture</strong>
</h2>

<p>To do</p>

<p><img src="https://raw.githubusercontent.com/pamu/AkkaDynoDB/master/images/todo.png" alt="To do"></p>

<p>Overall AkkaDynoDB looks like this</p>

<p><img src="https://raw.githubusercontent.com/pamu/AkkaDynoDB/master/images/cluster.png" alt="AkkaDynoDB"></p>

<p>Each Node in the cluster sends heart beats to every other node in the cluster to know whether a particluar
node is dead or alive.AkkaDynoDb uses Akka Cluster so, all that applies to Akka Cluster also applies to
AkkaDynoDB</p>

<p>Interactions of single Node of Cluster</p>

<p><img src="https://raw.githubusercontent.com/pamu/AkkaDynoDB/master/images/node.png" alt="AkkaDynoDB Node"></p>

<p>The above picture depicts the interactions of the single node with other nodes. All nodes are in consistent hashing ring</p>

<p>Node in detail</p>

<p><img src="https://raw.githubusercontent.com/pamu/AkkaDynoDB/master/images/node_detail.png" alt="AkkaDynoDB Node"></p>

<p>Each node in the cluster consists of these three components</p>

<ol>
<li>Service Actor</li>
<li>ConsistentHashing Router in the Service Actor</li>
<li>Storage Actor which persists the data into store</li>
</ol>

<h2>
<a id="service-actor" class="anchor" href="#service-actor" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Service Actor</strong>
</h2>

<p><em><strong>Service Actor</strong></em> receives all the client requests to persist and retrieve the data. Then the request is
sent to the Consistent Hashing router. The request consists of the Key which helps the Router to dispatch
the request to the final node in which the data is stored. If the key belongs to the Node itself
then the request is sent to the Storage Actor itself and will not be routed.</p>

<h2>
<a id="consistent-hashing-router" class="anchor" href="#consistent-hashing-router" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Consistent Hashing Router</strong>
</h2>

<p>This is inside the <em><strong>Service Actor</strong></em> . The responsibility of the router is to take the request and dispatch
it to the corresponding node which is responsible for handling the data. This is done by using the key in the request.
Also Consistent Hashing Router helps in both read and write request scalability there by preventing hot stops in the system.</p>

<h2>
<a id="storage-actor" class="anchor" href="#storage-actor" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Storage Actor</strong>
</h2>

<p><em><strong>Storage Actor</strong></em> is responsible for persisting the data and retrieving the data that is requested by the
Service Actor and this request is dispatched by the consistent hashing router in the service node.</p>

<p>Consistent Hashing Router</p>

<p><img src="https://raw.githubusercontent.com/pamu/AkkaDynoDB/master/images/ring.png" alt="AkkaDynoDB Node"></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/pamu/AkkaDynoDB/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/pamu/AkkaDynoDB/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/pamu/AkkaDynoDB"></a> is maintained by <a href="https://github.com/pamu">pamu</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
